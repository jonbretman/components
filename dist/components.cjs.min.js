"use strict";function type(a){return Object.prototype.toString.call(a).match(/\[object (.*?)\]/)[1].toLowerCase()}function isObject(a){return"object"===type(a)}function isFunction(a){return"function"===type(a)}function isElement(a){return a&&(1===a.nodeType||9===a.nodeType)}function isString(a){return"string"===type(a)}function noop(){return this}function toCamelCase(a){return a.replace(/\-(.)/g,function(a,b){return b.toUpperCase()})}function defaultDOMQuery(a,b){return a?a.querySelectorAll(b):[]}function defaultDOMWrapper(a){return a&&a.length?slice.call(a):[]}function extend(a){return slice.call(arguments,1).forEach(function(b){if(isObject(b))for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}),a}function closestElement(a,b){for(;a&&a!==doc.body;){if(matches(a,b))return a;a=a.parentElement}return null}function matches(a,b){var c="MatchesSelector",d=a["webkit"+c]||a["moz"+c]||a["ms"+c]||a["o"+c]||a.matchesSelector||a.matches;return d.call(a,b)}function parentComponents(a){var b=[];if(a===win||a===doc)return[];for(;isElement(a);)isComponent(a)&&b.push(a),a=a.parentElement;return b}function fromElement(a){return isComponent(a)?a:null}function invoke(a,b){var c,d=slice.call(arguments,2),e=0;if(isComponent(a)&&(a=[a]),!a)return this;for(c=a.length;c>e;e++)isFunction(a[e][b])&&a[e][b].apply(a[e],d);return this}function parseAttributes(a){for(var b,c,d={},e=0;e<a.attributes.length;e++){b=toCamelCase(a.attributes[e].name),c=a.attributes[e].value;try{c=JSON.parse(c)}catch(f){}d[b]=c}return d}function isComponent(a){return isElement(a)&&!!a.getAttribute("is")}function handleEvent(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=a.target,o=isComponent(n),p=o?n.getAttribute("is"):null,q=a.type;for(b||(b=parentComponents(o?n.el:n)),j=0,l=b.length;l>j;j++)if(c=b[j],d=c._events)for(k=0,m=d.length;m>k;k++)g=d[k][0],f=d[k][1],h=d[k][2],g===q&&(f?o?f===p&&h.call(c,a):(e=closestElement(n,f),e&&h.call(c,a,e)):h.call(c,a));if(i=globalHandlers[q])for(j=0,l=i.length;l>j;j++)i[j].fn.call(i[j].ctx,a,doc.body)}function register(a,b){var c,d,e={};return b=b||{},"extends"in b?(c=htmlPrototypes[b["extends"]],e["extends"]=b["extends"]):(c=HTMLElement.prototype,e["extends"]="div"),d=Object.create(c),Object.keys(customElementBase).forEach(function(a){d[a]=customElementBase[a]}),Object.keys(b).forEach(function(a){"extends"!==a&&(d[a]=b[a])}),e.prototype=d,document.registerElement(a,e)}function eventManager(a){var b,c;for(b in allEvents)c=-1!==["resize","scroll"].indexOf(b)?window:doc.body,c[a](b,handleEvent,!!allEvents[b])}function bindEvents(){eventManager("addEventListener")}function unbindEvents(){eventManager("removeEventListener")}function init(a){a=a||{},a.domQuery&&(domQuery=a.domQuery),a.domWrapper&&(domWrapper=a.domWrapper),bindEvents()}function reset(){slice.call(componentInstances).forEach(function(a){a.destroy()}),domQuery=defaultDOMQuery,domWrapper=defaultDOMWrapper,unbindEvents()}function getInstanceOf(a){return getInstancesOf(a)[0]}function getInstancesOf(a){return componentInstances.filter(function(b){return b.getAttribute("is")===a})}function destroy(a){return getInstancesOf(a).forEach(function(a){a.destroy()}),this}if("undefined"==typeof window)throw new Error("components requires an environment with a window");var win=window,doc=win.document,slice=[].slice,filter=[].filter,map=[].map,domQuery=defaultDOMQuery,domWrapper=defaultDOMWrapper,componentInstances=[],globalHandlers={},allEvents={click:!1,dblclick:!1,mousedown:!1,mouseup:!1,mousemove:!1,mouseleave:!0,mouseenter:!0,touchstart:!1,touchmove:!1,touchend:!1,keyup:!1,keydown:!1,error:!0,blur:!0,focus:!0,scroll:!0,submit:!0,change:!0,resize:!0,load:!0};exports.fromElement=fromElement,exports.isComponent=isComponent,exports.handleEvent=handleEvent;var htmlPrototypes={a:HTMLElement.prototype,form:HTMLFormElement.prototype,input:HTMLInputElement.prototype,select:HTMLSelectElement.prototype};exports.register=register,exports.bindEvents=bindEvents,exports.unbindEvents=unbindEvents,exports.init=init,exports.reset=reset,exports.getInstanceOf=getInstanceOf,exports.getInstancesOf=getInstancesOf,exports.destroy=destroy;var customElementBase={createdCallback:function(){componentInstances.push(this),this._events=[],this.el=this,this.$el=domWrapper([this]),this.opts=extend({},isFunction(this.defaultOptions)?this.defaultOptions():this.defaultOptions,parseAttributes(this)),this.init(),this.setupEvents(this.registerEvent.bind(this)),this.render()},attachedCallback:function(){this.onInsert(),this.emit("inserted")},detachedCallback:function(){this.onRemove()},setOptions:function(a){return extend(this.opts,a),this},template:null,init:noop,setupEvents:noop,render:function(){var a=this.template,b=isFunction(a),c=isString(a);return(b||c)&&(this.innerHTML=b?a.call(this,this):a),this},emit:function(a,b,c){b=b||{},b.target=b.target||this,b.type=a,b.customEvent=!0,handleEvent(b,c)},insertBefore:function(a){if(a=isElement(a)?a:null,!a)return this;var b=a.parentElement;return b&&b.insertBefore(this,a),this},insertAfter:function(a){if(a=isElement(a)?a:null,!a)return this;var b=a.parentNode;return b&&b.insertBefore(this,a.nextSibling),this},appendTo:function(a){return isElement(a)?(a.appendChild(this),this):this},onInsert:noop,remove:function(){return this.parentElement?(this.beforeRemove(),invoke(this.find("[is]"),"beforeRemove"),this.emit("remove"),this.parentElement.removeChild(this),this):this},beforeRemove:noop,onRemove:noop,beforeDestroy:noop,destroy:function(){var a=this;return this.beforeDestroy(),invoke(this.find("[is]"),"beforeDestroy"),this.remove(),componentInstances=componentInstances.filter(function(b){return b!==a}),null},find:function(a){return domWrapper(domQuery(this,a))},findComponent:function(a){return fromElement(this.find("[is="+a+"]")[0])},findComponents:function(a){return map.call(this.find("[is="+a+"]"),fromElement)},invoke:invoke,registerEvent:function(a,b,c){return 2===arguments.length&&(c=b,b=null),this._events.push([a,b,c]),this},releaseEvent:function(a,b,c){isFunction(b)&&!c&&(c=b,b=null),isFunction(c)||(c=null),"undefined"==typeof b&&(b=null),this._events=filter.call(this._events,function(d){var e=d[0],f=d[1],g=d[2];return c?!(e===a&&f===b&&g===c):!(e===a&&f===b)})},setGlobalHandler:function(a,b){return globalHandlers[a]=globalHandlers[a]||[],globalHandlers[a].push({fn:b,ctx:this}),this},releaseGlobalHandler:function(a,b){var c=globalHandlers[a],d=this;return c?(globalHandlers[a]=filter.call(c,function(a){return a.fn!==b||a.ctx!==d}),this):this}};